<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Birthday</title>
  <link rel="preload" as="image" href="meme.png">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: "Comic Sans MS", "Comic Neue", cursive, sans-serif;
      background: linear-gradient(135deg, #FFF200 0%, #FFD600 50%, #FFB300 100%);
      background-attachment: fixed;
      overflow: hidden;
    }

    .doodle { position: absolute; width: 120px; height: auto; opacity: 0.9; }
    .doodle1 { top: 100px; left: 90px; transform: rotate(10deg); }
    .doodle2 { bottom: 90px; right: 100px; transform: rotate(20deg); }
    .doodle3 { top: 80px; right: 50px; transform: rotate(-15deg); }

    .title-container {
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      height: 100vh; text-align: center;
    }

    .title {
      font-size: 4rem; color: #fff;
      text-shadow: 3px 3px 0 #000, -3px -3px 0 #FF4081; margin: 0;
      word-break: break-word;
    }

    .arrow-btn {
      margin-top: 40px; font-size: 2rem; padding: 14px 24px;
      background-color: #ffe45c; border: none; border-radius: 50px; cursor: pointer;
      color: #000; box-shadow: 2px 2px 6px rgba(0,0,0,0.3);
      transition: transform 0.2s ease, background-color 0.2s ease;
    }
    .arrow-btn:hover { background-color: #ff9100; transform: scale(1.05); }

    .surprise-btn {
      position: fixed; bottom: 20px; left: 20px; padding: 10px 18px;
      font-size: 1rem; font-weight: bold; background-color: #ff9900; color: white;
      border: none; border-radius: 8px; cursor: pointer; box-shadow: 2px 2px 6px rgba(0,0,0,0.3);
      transform: rotate(-5deg);
    }
    .surprise-btn:hover { background-color: #ffa600; transform: scale(1.05); }

    /* DO NOT CLICK button + counter (bottom-right) */
    .do-not-click-wrapper {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 10000;
      user-select: none;
    }

    .do-not-click-btn {
      background: #000;
      color: #fff;
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 2px 2px 6px rgba(0,0,0,0.4);
      transition: transform 0.12s ease;
    }
    .do-not-click-btn:active { transform: scale(0.98); }

    .counter-bubble {
      min-width: 64px;
      padding: 8px 10px;
      background: rgba(255,255,255,0.08);
      color: #fff;
      border-radius: 8px;
      text-align: center;
      font-weight: bold;
      border: 2px solid rgba(255,255,255,0.12);
      box-shadow: 1px 1px 4px rgba(0,0,0,0.3);
    }

    /* fullscreen reveal video */
    #special-video {
      display: none;
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: 9999;
      background: black;
    }
  </style>
</head>
<body>
  <!-- doodles -->
  <img src="doodle1.png" alt="doodle" class="doodle doodle1">
  <img src="doodle2.png" alt="doodle" class="doodle doodle2">
  <img src="doodle3.png" alt="doodle" class="doodle doodle3">

  <!-- original surprise -->
  <button class="surprise-btn" onclick="triggerJumpscare()">Click for a surprise :)</button>
  <img id="meme" src="meme.png" alt="meme" style="display:none;">
  <audio id="whistle" src="whistle.mp3"></audio>

  <!-- music -->
  <audio id="song" src="song.mp3" preload="auto"></audio>

  <!-- title area -->
  <div class="title-container">
    <h1 id="title" class="title">Happy Birthday, Mario!</h1>
    <button id="arrow" class="arrow-btn" onclick="startMessages()">â†’</button>
  </div>

  <!-- DO NOT CLICK wrapper (bottom-right) with counter -->
  <div class="do-not-click-wrapper" aria-hidden="false">
    <button id="doNotClick" class="do-not-click-btn">DO NOT CLICK</button>
    <div id="clickCounter" class="counter-bubble">0 / 150</div>
  </div>

  <!-- fullscreen 5-second video (file: special.mp4) -->
  <video id="special-video" src="special.mp4" playsinline webkit-playsinline></video>

  <script>
    // ---------- jumpscare ----------
    function triggerJumpscare() {
      const meme = document.getElementById('meme');
      const whistle = document.getElementById('whistle');
      meme.style.display = 'block';
      whistle.currentTime = 0;
      whistle.play().catch(() => {});
      setTimeout(() => { meme.style.display = 'none'; }, 4400);
    }

    // ---------- typewriter ----------
    let typingInterval = null;
    const arrowBtn = document.getElementById('arrow');

    function typeWriter(text, element, speed = 1000) {
      return new Promise((resolve) => {
        if (typingInterval !== null) {
          clearInterval(typingInterval);
          typingInterval = null;
        }
        element.textContent = '';
        let i = 0;
        if (arrowBtn) arrowBtn.disabled = true;
        typingInterval = setInterval(() => {
          element.textContent += text.charAt(i);
          i++;
          if (i >= text.length) {
            clearInterval(typingInterval);
            typingInterval = null;
            if (arrowBtn) arrowBtn.disabled = false;
            resolve();
          }
        }, speed);
      });
    }

    // ---------- messages ----------
    const messages = [
      "...", "?!?!", "!!!", "3 Octombrie!!!", "3 Octombrie 2025!!!", "ZIUA TA!!!",
      "Azi faci 18 ani!!!", "EÈ™ti major!!!", "PoÈ›i sÄƒ bei legal!!!",
      "Nu cÄƒ te prea interesa pe tine Ã®nainte dacÄƒ era legal sau nu...",
      "Dar acum poÈ›i sÄƒ bei legal!!!", "È˜i ce o sÄƒ bem!??",
      "Whisky, gin, rom, tequila, vodka, bere, vin...", "Orice vrei tu!!!", "A, da...",
      "ParcÄƒ trebuia sÄƒ spun ceva È™i de sÄƒnÄƒtate È™i de fericire...",
      "ÃŽÈ›i doresc multÄƒ sÄƒnÄƒtate, fericire, Ã®mpliniri, iubire, noroc...",
      "È˜i mai multÄƒ bÄƒuturÄƒ!!!", "Dar sÄƒ nu exagerezi...", "Anul Äƒsta ai bacul...",
      "Cum crezi cÄƒ o sÄƒ devii Chipsar È˜ef dacÄƒ nu iei bacul?",
      "Sau TraducÄƒtor Oficial RomÃ¢no-ÈšigÄƒneÈ™te pentru UE", "Sau SeducÄƒtor de capre",
      "Sau Specialist È˜ef Ã®n relocarea È›iganilor", "Sau VÃ¢nÄƒtor de È›igani",
      "Sau ÃŽmblÃ¢nzitor de urÈ™i (Pensionat din motive medicale)",
      "Sau Specialist Ã®n numÄƒrat È›igani la graniÈ›Äƒ",
      "Sau al 4-lea poet antisemit din RomÃ¢nia",
      "Sau Consultant Ã®n fugÄƒrit È›igani din sat",
      "Sau ÃŽmblÃ¢nzitor de È›igani(pensionat tot din motive medicale)",
      "Cel mai rÄƒu caz, ajungi È™ofer de tir...", "Glumesc, glumesc...", "Sau poate nu...",
      "Oricum, destule vorbe...", "SÄƒ te bucuri de ziua ta!!!"
    ];

    let currentIndex = 0;

    async function startMessages() {
      const title = document.getElementById('title');
      const song = document.getElementById('song');
      await typeWriter(messages[currentIndex], title, 40);
      currentIndex++;
      song.currentTime = 0;
      const playPromise = song.play();
      if (playPromise !== undefined) playPromise.catch(() => {});
      if (arrowBtn) arrowBtn.onclick = nextMessage;
    }

    async function nextMessage() {
      const title = document.getElementById('title');
      const song = document.getElementById('song');

      if (currentIndex < messages.length) {
        await typeWriter(messages[currentIndex], title, 40);
        currentIndex++;
      } else {
        await typeWriter("La mulÈ›i ani, Mario!!! ðŸŽ‰ðŸ¥³ðŸ»", title, 40);
        if (arrowBtn) arrowBtn.style.display = 'none';
        const fadeOutInterval = setInterval(() => {
          if (song.volume > 0.05) {
            song.volume = Math.max(0, song.volume - 0.05);
          } else {
            song.volume = 0;
            song.pause();
            song.currentTime = 0;
            clearInterval(fadeOutInterval);
            song.volume = 1;
          }
        }, 100);
      }
    }

    // ---------- DO NOT CLICK logic (video reveal) ----------
    const MAX_CLICKS = 150;
    const doBtn = document.getElementById('doNotClick');
    const counterEl = document.getElementById('clickCounter');
    const specialVideo = document.getElementById('special-video');

    let clicks = 0;
    let revealTimeout = null;
    let resetTimeout = null;

    function updateCounter() {
      counterEl.textContent = `${clicks} / ${MAX_CLICKS}`;
    }

    doBtn.addEventListener('click', async () => {
      // If a reveal is currently happening, ignore clicks
      if (specialVideo.style.display === 'block') return;

      clicks = Math.min(clicks + 1, MAX_CLICKS);
      updateCounter();

      // visual pulse
      doBtn.style.transform = 'scale(1.05)';
      setTimeout(() => { doBtn.style.transform = ''; }, 100);

      if (clicks >= MAX_CLICKS) {
        triggerVideoReveal();
      }
    });

    async function triggerVideoReveal() {
      // disable button to avoid extra clicks
      doBtn.disabled = true;

      // Show and play the video. Use user gesture (last click) to allow autoplay.
      specialVideo.style.display = 'block';
      specialVideo.currentTime = 0;
      specialVideo.volume = 1;
      const playPromise = specialVideo.play();
      if (playPromise !== undefined) {
        try { await playPromise; } catch (e) { /* autoplay blocked fallback */ }
      }

      // Ensure the reveal lasts 5 seconds; if the video is shorter/longer, force hide after 5s
      revealTimeout = setTimeout(() => {
        endVideoReveal();
      }, 5000);

      // safety: if video ends earlier than 5s, still run endVideoReveal shortly after
      specialVideo.onended = () => {
        if (revealTimeout) clearTimeout(revealTimeout);
        // short delay so 'ended' isn't abrupt
        resetTimeout = setTimeout(() => endVideoReveal(), 200);
      };
    }

    function endVideoReveal() {
      // hide video and reset state
      specialVideo.pause();
      specialVideo.currentTime = 0;
      specialVideo.style.display = 'none';

      // reset counter and re-enable button
      clicks = 0;
      updateCounter();
      doBtn.disabled = false;

      // clear timeouts/handlers
      if (revealTimeout) { clearTimeout(revealTimeout); revealTimeout = null; }
      if (resetTimeout) { clearTimeout(resetTimeout); resetTimeout = null; }
      specialVideo.onended = null;
    }

    // cleanup on unload
    window.addEventListener('beforeunload', () => {
      if (revealTimeout) clearTimeout(revealTimeout);
      if (resetTimeout) clearTimeout(resetTimeout);
    });

    // initialize counter display
    updateCounter();
  </script>
</body>
</html>
